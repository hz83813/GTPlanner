# 提示词优化总结

## 🎯 优化目标

根据用户反馈，当前返回的内容不是用户需要的，需要优化提示词让大模型返回**产品需求文档（PRD）**相关的内容。

---

## ✅ 已完成的优化

### 1. 系统编排器提示词优化

**文件**: `agent/prompts/templates/system/orchestrator.py`

#### 优化内容：

1. **角色定位调整**
   - 从"需求澄清助手和设计文档生成器"
   - 改为"智能的产品需求文档（PRD）生成助手"

2. **任务目标调整**
   - 明确生成"产品需求文档（PRD）"
   - 包含功能需求、非功能需求、用户故事

3. **工作原则优化**
   ```python
   # 新增原则
   1. **专注于PRD生成**
      - 理解用户需求的核心价值
      - 生成完整的产品需求文档
      - 包含功能需求、用户场景、验收标准

   2. **智能理解需求**
      - 对于"设计XXX系统"的需求，理解为完整的产品需求
      - 自动扩展缺失的场景（如：文件上传/下载/搜索等）
      - 生成全面的产品功能列表

   3. **生成完整文档**
      - 调用 `design` 工具生成完整PRD
      - 包含产品概述、详细功能需求、用户故事、非功能需求
   ```

4. **典型流程优化**
   - 优化了"需求明确"流程
   - 增加自动补充关键功能
   - 强调生成全面的PRD文档

---

### 2. Design节点提示词优化

**文件**: `agent/prompts/templates/agents/design/design_node.py`

#### 优化内容：

1. **角色定位**：
   - 从"系统架构师"
   - 改为"产品需求文档（PRD）撰写专家"

2. **核心原则新增**：
   ```python
   1. **专注于产品需求**：从产品角度描述需要实现的功能特性
   2. **用户视角**：以用户价值为核心，描述功能如何解决用户问题
   3. **完整详细**：包含功能描述、用户场景、验收标准、优先级
   4. **结构化输出**：生成适合AI驱动的技术实现的设计文档
   5. **适用于vibe coding**：输出格式要适合Cursor、Windsurf等AI开发工具使用
   ```

3. **任务目标**：
   ```python
   1. 全面理解用户需求并自动补充核心功能
   2. 包含产品概述、功能特性、用户场景、技术方案
   3. 输出适合AI驱动的技术实现的设计文档
   ```

4. **重要提示**：
   ```python
   - 如果用户说"设计XXX系统"，要理解为**完整的产品需求**
   - 自动补充该类型系统的核心功能（如用户管理系统的注册、登录、权限等）
   - 生成全面而详细的PRD文档
   ```

---

## 🎯 优化效果

### 预期改进：

1. **更准确的定位**
   - 系统将专注于生成PRD文档
   - 不再是技术实现细节，而是产品需求

2. **智能需求理解**
   - 对于"设计XXX系统"的需求
   - 自动补充该系统的核心功能
   - 生成全面的产品需求列表

3. **完整的功能覆盖**
   - 用户输入"设计用户管理系统"
   - 系统会理解并生成包含：
     - 用户注册功能
     - 用户登录功能
     - 权限管理功能
     - 用户信息管理功能
     - 等等...

4. **适合AI驱动的输出**
   - 文档格式适合vibe coding
   - 可以直接用于AI开发工具

---

## 🧪 测试建议

### 测试用例：

1. **简单需求**
   - 输入：设计一个用户管理系统
   - 预期：生成包含注册、登录、权限等完整功能的PRD

2. **复杂需求**
   - 输入：设计一个在线课程平台
   - 预期：生成包含课程管理、用户学习、支付等功能的PRD

3. **模糊需求**
   - 输入：设计一个智能系统
   - 预期：先澄清需求，然后生成PRD

---

## 📋 下一步

1. **重启服务**：让优化后的提示词生效
2. **测试验证**：使用测试用例验证效果
3. **收集反馈**：确认返回的内容是否符合预期

---

## 🔄 如何应用

提示词已经优化完成，需要：
1. 重启FastAPI服务
2. 测试新的提示词效果
3. 验证返回的PRD内容是否符合要求

**提示词优化已完成！** 🎉

